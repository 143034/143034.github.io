---
title: 定时器和计数器
date: 2020-09-15 13:42:15
tags:
- 51
categories:
- 单片机
- 52单片机
---

# 一、介绍 #

> 定时器/计数器0有4种工作模式：模式0(13位定时器/计数器),模式1(16位定时器/计数器模式),模式2(8位自动重装模式)，模式3(两个8位定时器/计数器)。定时器/计数器1除模式3外，其他工作模式与定时器/计数器0相同，T1在模式3时无效，停止计数。

# 二、寄存器介绍 #

### 2.1、相关寄存器 ###

![相关寄存器](/images/单片机/52单片机/定时器与计数器/相关寄存器.png)


### 2.2、定时器/计数器控制寄存器TCON ###

![TCON寄存器](/images/单片机/52单片机/定时器与计数器/TCON寄存器.png)


### 2.3、定时器/计数器工作模式寄存器TMOD ###

![TMOD寄存器](/images/单片机/52单片机/定时器与计数器/TMOD寄存器.png)

# 三、工作模式 #

通过对寄存器TMOD中的M1(TMOD.1)、M0(TMOD.0)的设置，**定时器/计数器0有4种不同的工作模式**

### 3.1、模式0(13位定时器/计数器) ###

![工作方式0](/images/单片机/52单片机/定时器与计数器/工作方式0.png)


**此模式下，定时器0配置为13位的计数器，由TL0的低5位和TH0的8位所构成。TL0低5位溢出向TH0进位，TH0计数溢出置位TCON中的溢出标志位TF0。GATE(TMOD.3)=0 时，如TR0=1，则定时器计数。GATE=1 时，允许由外部输入INT1控制定时器1，INT0控制定时器0，这样可实现脉宽测量。**

当C/T=0时，多路开关连接到系统时钟的分频输出，T0对时钟周期计数，T0工作在定时方式。当C/T=1时，多路开关连接到外部脉冲输入P3.4/T0，即T0工作在计数方式。


### 3.2、模式1(16位定时器/计数器) ###

![工作方式1](/images/单片机/52单片机/定时器与计数器/工作方式1.png)

模式1除了**使用了TH0及TL0全部16位**外，其他与模式0完全相同。即此模式下定时器/计数器0作为16位定时器/计数器。

**此模式下，定时器配置为16位定时器/计数器，由TL0的8位和TH0的8位所构成TL0的8位溢出向TH0进位，TH0计数溢出置位TCON中的溢出标志位TF0。当GATE=0(TMOD.3)时，如TR0=1，则定时器计数。GATE=1时，允许由外部输入INT0控制定时器0，这样可实现脉宽测量。TR0为TCON寄存器内的控制位。**

当C/T=0时，多路开关连接到系统时钟的分频输出，T0对时钟周期计数，T0工作在定时方式。当C/T=1时，多路开关连接到外部脉冲输入P3.4/T0，即T0工作在计数方式。



### 3.3、模式2(8位自动重装模式) ###

![工作方式2](/images/单片机/52单片机/定时器与计数器/工作方式2.png)

**此模式下定时器/计数器0作为可自动重装载的8位计数器。**

**TL0的溢出不仅置位TF0，而且将TH0内容重新装入TL0，TH0内容由软件预置，重装时TH0内容不变。**




### 3.4、模式3(两个8位计数器) ###

![工作方式3](/images/单片机/52单片机/定时器与计数器/工作方式3.png)

**对定时器1，在模式3时，定时器1停止计数，效果与将TR1设置为0相同。**



**对定时器0，此模式下定时器0的TL0及TH0作为2个独立的8位计数器。下图为模式3时的定时器0逻辑图。TL0占用定时器0的控制位：C/T、GATE、TR0、INT0及TF0。TH0限定为定时器功能（计数器周期），占用定时器1的TR1及TF1。此时，TH0控制定时器1中断。**




**模式3是为了增加一个附加的8位定时器/计数器而提供的，使单片机具有三个定时器/计数器。模式3只适用于定时器/计数器0，定时器T1处于模式3时相当于 TR1=0，停止计数，而T0可 作为两个定时器用。**



